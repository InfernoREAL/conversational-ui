"use strict";var structure={menu:[{title:"Projects",id:"projects",submenu:[{title:"Project 1",id:"p1"},{title:"Project 2",id:"p2"},{title:"Project 3",id:"p3"}]},{title:"Writing",id:"writing",submenu:[{title:"Articles",id:"articles"},{title:"Theses",id:"theses"}]},{title:"Contact",id:"contact",submenu:[{title:"Social media",id:"socialmedia"},{title:"Email",id:"email"},{title:"Address",id:"address"}]}]},idle=void 0,idletime=45e3,chat=document.querySelector(".chat"),content=document.querySelector(".content"),newMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",n=document.createElement("section"),o=function(e,t){setTimeout(function(){e.classList.add("show")},150*t?150*t:10)},a=void 0,i=function(){chat.scrollTop+=Math.floor(n.offsetHeight/18)};if(n.classList.add("message"),n.classList.add(t),n.innerHTML="<p>"+e+"</p>",chat.appendChild(n),a=window.setInterval(i,16),setTimeout(function(){window.clearInterval(a),chat.scrollTop=chat.scrollHeight},300),setTimeout(function(){n.classList.add("show")},10),"user"===t){for(var s=chat.querySelectorAll("button:not(:disabled)"),c=0;c<s.length;c+=1)o(s[c],c);n.classList.add("active")}},randomReply=function(e){return e[Math.floor(Math.random()*e.length)]},checkUp=function(){var e=document.querySelector(".active"),t=["Did you fall asleep? &#x1F634;","Coffee break? &#x2615;","Still there?","&#x2744; &#x1F331; &#x1F31E; &#x1F342;"];e&&e.parentNode.removeChild(e),newMessage(randomReply(t),"bot"),setTimeout(function(){var e=['Don\'t like this conversation? Send an email to <a href="mailto:mike@redvolume.com">mike@redvolume.com</a> if you want a real one. &#x1F680;','Not finding what you\'re looking for? Send an email to <a href="mailto:mike@redvolume.com">mike@redvolume.com</a> with any questions...','Wanna talk to a real person? &#x1F4AC; Fire off an email to <a href="mailto:mike@redvolume.com">mike@redvolume.com</a>. &#x1F525;'];newMessage(randomReply(e),"bot"),setTimeout(function(){var e=["Where's the normal web page? &#x1F61E;","I want a regular web page &#x1F631;","Do you have a regular website? &#x1F63B;"],t=["Show me the options again please &#x2705;","Ok, go! &#x1F697;","I wanna check something &#x1F44D;"];newMessage('<button class="choice newmenu showinfo">'+randomReply(e)+'</button><br /><button class="choice newmenu showmenu">'+randomReply(t)+"</button>")},300)},500)},init=function(){var e=["Hello! &#x1F44B; I'm Mike, a medical librarian working at Karolinska Institutet. I try to create the best user experiences possible, both physical and virtual, using humour, friendliness, web technologies and good design."];idle=window.setInterval(function(){window.clearInterval(idle),checkUp()},idletime),newMessage(randomReply(e),"bot"),setTimeout(function(){var e=["Hey, tell me more! &#x1F680;","Hi! &#x1F440;","I'll bite &#x1F604;"];newMessage('<button class="choice start">'+randomReply(e)+"</button>")},300)},makeUserBubble=function(e){e.parentNode.parentNode.classList.add("selected"),e.parentNode.parentNode.classList.remove("active"),e.parentNode.innerHTML=e.textContent},showMenu=function(e){var t="",n=chat.querySelector("button.newmenu"),o=["Here's a few things that I can tell you about... &#x1F3A4;","Ok, check this out! &#x1F447;","Anything else you're interested in? &#x1F64F;"],a=["What would you like to know more about? &#x1F4A1;","Can I interest you in any of this? &#x1F4AF;","Select something of the following... &#x1F447;"];n&&makeUserBubble(n),setTimeout(function(){e?newMessage(randomReply(o),"bot"):newMessage(randomReply(a),"bot"),structure.menu.forEach(function(e,n){t+='<button class="choice menu" data-submenu="'+n+'">'+e.title+"</button>"}),setTimeout(function(){newMessage(t)},300)},500),idle=window.setInterval(function(){window.clearInterval(idle),checkUp()},idletime)},menuClick=function(e){var t="",n=structure.menu[e.getAttribute("data-submenu")],o=["&#x1F44D; Here's what I have on that...","See anything interesting? &#x1F648;","Any of this cool?"],a=["I wanna read about something other than "+n.title.toLowerCase()+" &#x1F61C;","Show me the menu again &#x1F60B;",n.title+" was interesting, but show me something else... &#x1F612;"];n.submenu.forEach(function(e){var o=n.id+"-"+e.id;t+='<button class="choice submenu" aria-controls="'+o+'" data-content="'+o+'">'+e.title+"</button>"}),t+='<br /><button class="choice submenu newmenu">'+randomReply(a)+"</button>",setTimeout(function(){newMessage(randomReply(o),"bot"),setTimeout(function(){newMessage(t)},300)},500)},toggleContent=function(e){var t=chat.querySelectorAll("button");e?(e.classList.add("show"),chat.setAttribute("aria-hidden","true"),content.setAttribute("aria-hidden","false"),content.tabIndex="0",content.focus()):(content.setAttribute("aria-hidden","true"),content.tabIndex="-1",chat.setAttribute("aria-hidden","false"),history.state&&"content"===history.state.id&&history.back(),setTimeout(function(){var e=document.querySelector(".content article.show");e&&(e.classList.remove("show"),chat.querySelector('button[data-content="'+e.id+'"]').focus())},300));for(var n=0;n<t.length;n+=1)t[n].tabIndex=e?"-1":"0"},subMenuClick=function(e){e.classList.contains("newmenu")?showMenu(!0):(toggleContent(document.getElementById(e.getAttribute("data-content"))),history.pushState({id:e.getAttribute("data-content")},"","#"+e.getAttribute("data-content")))};if(document.addEventListener("click",function(e){if(e.target.classList.contains("choice")&&(window.clearInterval(idle),e.target.classList.contains("submenu")||makeUserBubble(e.target),e.target.classList.contains("menu")&&menuClick(e.target),e.target.classList.contains("submenu")&&subMenuClick(e.target),e.target.classList.contains("start")&&showMenu(),e.target.classList.contains("showmenu")&&showMenu(!0),e.target.classList.contains("showinfo"))){var t=["Here's my website ","Here you go: ","Check this one out "],n=["OK &#x1F60E;","How do I get back? &#x1F312;","Ok, thanks! &#x1F44C;"];setTimeout(function(){newMessage(randomReply(t)+' <a target="_new" href="https://librarian.codes">https://librarian.codes</a>',"bot"),setTimeout(function(){newMessage('<button class="choice newmenu showmenu">'+randomReply(n)+"</button>")},300)},500)}e.target.classList.contains("close")&&(e.preventDefault(),history.back())}),document.addEventListener("keydown",function(e){27===e.keyCode&&"false"===content.getAttribute("aria-hidden")&&history.back()}),window.addEventListener("popstate",function(e){toggleContent(e.state&&e.state.id&&document.getElementById(e.state.id)?document.getElementById(e.state.id):"")}),setTimeout(function(){init()},500),document.getElementById(window.location.hash.split("#")[1])){var contentId=window.location.hash.split("#")[1];history.replaceState("","","."),setTimeout(function(){toggleContent(document.getElementById(contentId)),history.pushState({id:contentId},"","#"+contentId)},10)}